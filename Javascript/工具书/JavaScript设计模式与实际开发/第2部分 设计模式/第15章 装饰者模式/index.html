<!-- 1 æ¨¡æ‹Ÿä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€çš„è£…é¥°è€…æ¨¡å¼ -->
<!-- <script>
  var Plane = function () {};

  Plane.prototype.fire = function () {
    console.log('å‘å°„æ™®é€šå­å¼¹');
  };

  var MissileDecorator = function (plane) {
    this.plane = plane;
  };

  MissileDecorator.prototype.fire = function () {
    this.plane.fire();
    console.log('å‘å°„å¯¼å¼¹');
  };

  var AtomDecorator = function (plane) {
    this.plane = plane;
  };

  AtomDecorator.prototype.fire = function () {
    this.plane.fire();
    console.log('å‘å°„åŸå­å¼¹');
  };

  var plane = new Plane();
  plane = new MissileDecorator(plane);
  // plane = new AtomDecorator(plane);

  plane.fire();
  // åˆ†åˆ«è¾“å‡ºï¼š å‘å°„æ™®é€šå­å¼¹ã€å‘å°„å¯¼å¼¹ã€å‘å°„åŸå­å¼¹
</script> -->

<!-- 2 å›åˆ° JavaScript çš„è£…é¥°è€… -->
<!-- <script>
  var plane = {
    fire: function () {
      console.log('å‘å°„æ™®é€šå­å¼¹');
    }
  };

  var missileDecorator = function () {
    console.log('å‘å°„å¯¼å¼¹');
  };

  var atomDecorator = function () {
    console.log('å‘å°„åŸå­å¼¹');
  };

  var fire1 = plane.fire;

  plane.fire = function () {
    fire1();
    missileDecorator();
  };

  var fire2 = plane.fire;

  plane.fire = function () {
    fire2();
    atomDecorator();
  };

  plane.fire();
  // åˆ†åˆ«è¾“å‡ºï¼š å‘å°„æ™®é€šå­å¼¹ã€å‘å°„å¯¼å¼¹ã€å‘å°„åŸå­å¼¹
</script> -->

<!-- 3 è£…é¥°å‡½æ•° -->

<!-- 
<button id="button">æŒ‰é’®</button>
<script>
  // var a = function () {
  //   alert(1);
  // };

  // var _a = a;

  // a = function () {
  //   _a();
  //   alert(2);
  // };

  // a();

  /********************************/

  // window.onload = function () {
  //   alert(1);
  // };

  // var _onload = window.onload || function () {};

  // window.onload = function () {
  //   _onload();
  //   alert(2);
  // };

  /********************************/

  // var _getElementById = document.getElementById;

  // document.getElementById = function (id) {
  //   alert(1);
  //   return _getElementById; // (1)
  // };
  // var button = document.getElementById('button');

  /********************************/

  // var _getElementById = document.getElementById;

  // document.getElementById = function (id) {
  //   alert(1);
  //   return _getElementById.apply(document, arguments); // (1)
  // };
  // var button = document.getElementById('button');
</script>
-->

<!-- ç”¨ AOP è£…é¥°å‡½æ•° -->
<!-- <button id="button">æŒ‰é’®</button>
<script>
  Function.prototype.before = function (beforefn) {
    var __self = this; // ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨
    return function () {
      // è¿”å›åŒ…å«äº†åŸå‡½æ•°å’Œæ–°å‡½æ•°çš„"ä»£ç†"å‡½æ•°
      beforefn.apply(this, arguments); // æ‰§è¡Œæ–°å‡½æ•°ï¼Œä¸”ä¿è¯this ä¸è¢«åŠ«æŒï¼Œæ–°å‡½æ•°æ¥å—çš„å‚æ•°
      // ä¹Ÿä¼šè¢«åŸå°ä¸åŠ¨åœ°ä¼ å…¥åŸå‡½æ•°ï¼Œæ–°å‡½æ•°åœ¨åŸå‡½æ•°ä¹‹å‰æ‰§è¡Œ
      return __self.apply(this, arguments); // æ‰§è¡ŒåŸå‡½æ•°å¹¶è¿”å›åŸå‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œ
      // å¹¶ä¸”ä¿è¯this ä¸è¢«åŠ«æŒ
    };
  };

  Function.prototype.after = function (afterfn) {
    var __self = this;
    return function () {
      var ret = __self.apply(this, arguments);
      afterfn.apply(this, arguments);
      return ret;
    };
  };

  // function sayHi() {
  //   console.log('ğŸš©  -> file: index.html -> line 152 -> ', 'æˆ‘æ˜¯å°å¸…å“¥');
  // }
  // sayHi = sayHi
  //   .before(() => {
  //     console.log('ğŸš©  -> file: index.html -> line 155 -> ', 'ä½ å¥½ï¼Œ');
  //   })
  //   .after(() => {
  //     console.log('ğŸš©  -> file: index.html -> line 159 -> ', 'å†è§ï¼');
  //   });

  // sayHi();

  // document.getElementById = document.getElementById.before(() => {
  //   alert(1);
  // });

  // var button = document.getElementById('button');
  // console.log(button);

  // window.onload = function () {
  //   alert(1);
  // };

  // window.onload = (window.onload || function () {})
  //   .after(function () {
  //     alert(2);
  //   })
  //   .after(function () {
  //     alert(3);
  //   })
  //   .after(function () {
  //     alert(4);
  //   });

  /********************************/

  var before = function (fn, beforefn) {
    return function () {
      beforefn.apply(this, arguments);
      return fn.apply(this, arguments);
    };
  };

  var a = before(
    function () {
      alert(3);
    },
    function () {
      alert(2);
    }
  );

  a = before(a, function () {
    alert(1);
  });

  a();
</script> -->

<!-- AOP çš„åº”ç”¨å®ä¾‹  -->

<!-- 1  æ•°æ®ç»Ÿè®¡ä¸ŠæŠ¥ -->

<!-- <html>
  <button tag="login" id="button">ç‚¹å‡»æ‰“å¼€ç™»å½•æµ®å±‚</button>
  <script>
    // var showLogin = function () {
    //   console.log('æ‰“å¼€ç™»å½•æµ®å±‚');
    //   log(this.getAttribute('tag'));
    // };

    // var log = function (tag) {
    //   console.log('ä¸ŠæŠ¥æ ‡ç­¾ä¸º: ' + tag);
    //   // (new Image).src = 'http:// xxx.com/report?tag=' + tag;    // çœŸæ­£çš„ä¸ŠæŠ¥ä»£ç ç•¥
    // };

    // document.getElementById('button').onclick = showLogin;

    /**************** AOP åˆ‡ç‰‡ ****************/

    Function.prototype.after = function (afterfn) {
      var __self = this;
      return function () {
        var ret = __self.apply(this, arguments);
        afterfn.apply(this, arguments);
        return ret;
      };
    };

    var showLogin = function () {
      console.log('æ‰“å¼€ç™»å½•æµ®å±‚');
    };

    var log = function (tag) {
      console.log('ä¸ŠæŠ¥æ ‡ç­¾ä¸º: ' + this.getAttribute('tag'));
    };

    showLogin = showLogin.after(log);

    document.getElementById('button').onclick = showLogin;
  </script>
</html> -->

<!-- 2.ç”¨ AOPåŠ¨æ€æ”¹å˜å‡½æ•°çš„å‚æ•° -->

<!-- <script>
  Function.prototype.before = function (beforefn) {
    var __self = this;
    return function () {
      beforefn.apply(this, arguments); // (1)
      return __self.apply(this, arguments); // (2)
    };
  };

  // var func = function (param) {
  //   console.log(param); // è¾“å‡ºï¼š {a: "a", b: "b"}
  // };

  // func = func.before(function (param) {
  //   param.b = 'b';
  // });

  // func({ a: 'a' });

  var ajax = function (type, url, param) {
    console.log(param); // å‘é€ajax è¯·æ±‚çš„ä»£ç ç•¥
  };

  var getToken = function () {
    return 'Token';
  };

  ajax = ajax.before(function (type, url, param) {
    param.Token = getToken();
  });

  ajax('get', 'http:// xxx.com/userinfo', { name: 'sven' });
  // {name: "sven", Token: "Token
</script> -->

<!-- 3  æ’ä»¶å¼çš„è¡¨å•éªŒè¯ -->

<html>
  <body>
    ç”¨æˆ·åï¼š<input id="username" type="text" />
    å¯†ç ï¼š
    <input id="password" type="password" />
    <input id="submitBtn" type="button" value="æäº¤" />
  </body>

  <script>
    Function.prototype.before = function (beforefn) {
      var __self = this;
      return function () {
        if (beforefn.apply(this, arguments) === false) {
          // beforefn è¿”å›false çš„æƒ…å†µç›´æ¥returnï¼Œä¸å†æ‰§è¡Œåé¢çš„åŸå‡½æ•°
          return;
        }
        return __self.apply(this, arguments);
      };
    };

    // var username = document.getElementById('username'),
    //   password = document.getElementById('password'),
    //   submitBtn = document.getElementById('submitBtn');

    // var validata = function () {
    //   if (username.value === '') {
    //     alert('ç”¨æˆ·åä¸èƒ½ä¸ºç©º');
    //     return false;
    //   }
    //   if (password.value === '') {
    //     alert('å¯†ç ä¸èƒ½ä¸ºç©º');
    //     return false;
    //   }
    // };

    // var fetch = function () {
    //   var param = {
    //     username: username.value,
    //     password: password.value
    //   };

    //   console.log('ğŸš©  -> file: index.html -> line 328 -> ', 'å‘é€è¯·æ±‚', param);
    //   // ajax('http:// xxx.com/login', param);
    // };

    // const formSubmit = fetch.before(validata);

    // submitBtn.onclick = function () {
    //   formSubmit();
    // };

    // var func = function () {
    //   alert(1);
    // };
    // func.a = 'a';

    // func = func.after(function () {
    //   alert(2);
    // });

    // alert(func.a); // is not a function
  </script>
</html>
